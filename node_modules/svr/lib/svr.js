var template = require('template'),
    mo = require('mo'),
    mutil = mo.util;

var svr = mo.mclass.create({
    init: function() {
        console.log('App has been inited !');
        /*
        在页面中，通过request.app获取全局参数，包括用户,cookie等
         */
        this.app = {};
    },
    //开始监听
    listen: function() {
        var server = require('http').createServer(function(request, resposne) {
            mo.server.packRequest(request, this);
            resposne.writeHead(200, {
                'Content-Type': 'text/html'
            });
            resposne.write(JSON.stringify(request.$uagent)+'<br/>'+
                JSON.stringify(request.headers['user-agent']));
            resposne.end();
        });
        server.listen(3000, '127.0.0.1');
        // 创建
        // 设置
        // 开始监控
        // console.log(mutil.isFunction([]));
    }
});
// console.log(svr.prototype);

module.exports = function(cfg) {
    return new svr(cfg);
};
